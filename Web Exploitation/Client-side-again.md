## Description

> Can you break into this super secure portal? https://jupiter.challenges.picoctf.org/problem/60786/ (link) or http://jupiter.challenges.picoctf.org:60786
 

## Hints

What is obfuscation?


## Approach & Solution

We need to understand what is [obfuscation](https://en.wikipedia.org/wiki/Obfuscation). In short, it is making a language harder to read and understand using another complex to read and understand language.

Let's follow the same steps as we did in `dont-use-client-side` challenge with some additional steps to get the flag:

1. Press `F12` to inspect the website.
2. Expand the `script` tags, and look for the `verify()` function, you'll find it in the same `script` tag as before.
3. Notice that this time the function is full of hex code and is hard to understand, let's de-obfuscate the javascript function using an online tool [here](http://www.jsnice.org/)
4. Copy the function in the `script` tag, paste it into the website in step (3), and hit `NICEFY JAVASCRIPT`.
5. Copy and paste the result into notepad or any text editor:

The result is:

```
'use strict';
/** @type {!Array} */
var _0x5a46 = ["f49bf}", "_again_e", "this", "Password Verified", "Incorrect password", "getElementById", "value", "substring", "picoCTF{", "not_this"];
(function(data, i) {
  /**
   * @param {number} isLE
   * @return {undefined}
   */
  var write = function(isLE) {
    for (; --isLE;) {
      data["push"](data["shift"]());
    }
  };
  write(++i);
})(_0x5a46, 435);
/**
 * @param {string} level
 * @param {?} ai_test
 * @return {?}
 */
var _0x4b5b = function(level, ai_test) {
  /** @type {number} */
  level = level - 0;
  var rowsOfColumns = _0x5a46[level];
  return rowsOfColumns;
};
/**
 * @return {undefined}
 */
function verify() {
  checkpass = document[_0x4b5b("0x0")]("pass")[_0x4b5b("0x1")];
  /** @type {number} */
  split = 4;
  if (checkpass[_0x4b5b("0x2")](0, split * 2) == _0x4b5b("0x3")) {
    if (checkpass[_0x4b5b("0x2")](7, 9) == "{n") {
      if (checkpass[_0x4b5b("0x2")](split * 2, split * 2 * 2) == _0x4b5b("0x4")) {
        if (checkpass[_0x4b5b("0x2")](3, 6) == "oCT") {
          if (checkpass[_0x4b5b("0x2")](split * 3 * 2, split * 4 * 2) == _0x4b5b("0x5")) {
            if (checkpass["substring"](6, 11) == "F{not") {
              if (checkpass[_0x4b5b("0x2")](split * 2 * 2, split * 3 * 2) == _0x4b5b("0x6")) {
                if (checkpass[_0x4b5b("0x2")](12, 16) == _0x4b5b("0x7")) {
                  alert(_0x4b5b("0x8"));
                }
              }
            }
          }
        }
      }
    }
  } else {
    alert(_0x4b5b("0x9"));
  }
}
;

```

6. Notice that the values in the result are related to the `_0x4b5b` variable, and it is a javascript variable and to find it's values go to `Console` in the inspect element window and write it's name and hit enter:

We will get: \["getElementById", "value", "substring", "picoCTF{", "not_this", "f49bf}", "_again_e", "this", "Password Verified", "Incorrect password"\]

7. Index the array above from index **0** to index **9**
8. replace the `_0x4b5b("0xY` values in the above code with the strings from the array above whereas `Y`is the index in the array:

The final code of `verify()` looks like:

```
function verify() {
  checkpass = document[getElementById]("pass")[value];
  /** @type {number} */
  split = 4;
  if (checkpass[substring](0, split * 2) == picoCTF{) {
    if (checkpass[substring](7, 9) == "{n") {
      if (checkpass[substring](split * 2, split * 2 * 2) == not_this) {
        if (checkpass[substring](3, 6) == "oCT") {
          if (checkpass[substring](split * 3 * 2, split * 4 * 2) == f49bf}) {
            if (checkpass["substring"](6, 11) == "F{not") {
              if (checkpass[substring](split * 2 * 2, split * 3 * 2) == _again_e)) {
                if (checkpass[substring](12, 16) == this) {
                  alert(Password Verified);
                }
              }
            }
          }
        }
      }
    }
  } else {
    alert(Incorrect password);
  }
}
;
```
9. Let's sort out the characters we got(notice that split==4):
```
0-8: picoCTF{
7-9: {n
8-16: not_this
3-6: oCT
24-32: f49bf}
6-11: F{not
16-24: _again_e
```
10. Form the final flag while eleminating redundant letters: `picoCTF{not_this_again_ef49bf}`


## Final Answer

`picoCTF{not_this_again_ef49bf}`

