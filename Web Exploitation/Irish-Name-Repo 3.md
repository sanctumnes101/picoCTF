## Description

> There is a secure website running at https://jupiter.challenges.picoctf.org/problem/29132/ (link) or http://jupiter.challenges.picoctf.org:29132. Try to see if you can login as admin!
 

## Hints

> Seems like the password is encrypted.


## Approach & Solution

This is follow-up to Irish-Name-Repo 2. Let's head to the `Admin Login` page again. This time, we notice that there is only a password field.
Let's try some random input, for example: `asd`. We get redirected to the `/login.php` page again. Recall that the payload probably looks like this: `SELECT * FROM users WHERE username='admin' and password='asd'`. How can we know for sure that the SQL statement is like this? maybe there is something hidden on the page?
If you remember the first few challenges, there were hidden things from users that we found out using the `inspect elements` window. Let's try that out here!

Inspect the page using the `F12` button. Notice that there is a `hidden` field out there: `<input type="hidden" name="debug" value="0">`. What happens if we change the `value` of this hidden field to `1`? Let's check it out!
Change the `value` to `1`, enter the `asd` password again, and try to login. We got redirected to `/login.php` again, but this time we can see the SQL statemnt being used: ` SELECT * FROM admin where password = 'nfq'`.

We need to modify this statement and bypass the filter:  `SELECT * FROM admin where password = 'nfq'`

Notice that we can only insert the payload after the `password` column. We want to bypass the password check. We can do that with the following payload: `' or 1=1--`.

Explanation:

The SQL statemnt with the above payload will look like: SELECT * FROM admin where password ='' or 1=1-- 
This says that we will select everything from the admin column where the password is empty, or the equation 1=1 is true, and it is always true!

Let's enter the payload `' or 1=1--` with the debug value of 1 in the hidden input and see what happens. Oops! it got filtered, but the SQL statement we got isn't exactly what we wrote: `SELECT * FROM admin where password = '' be 1=1--'`.

`or` turned into `be`. It seems like there is some kind of rotation encryption to the alphabet characters. It is easy to find out that the rotation is by 13 characters, so `or` will turn to `be`, and in the other direction `be` will turn into `or`.

Let's try the updated payload: `' be 1=1--`. Boom! we got the flag: `picoCTF{3v3n_m0r3_SQL_06a9db19}`


## Final Answer

`picoCTF{3v3n_m0r3_SQL_06a9db19}`
