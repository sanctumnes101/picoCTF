## Description

> The image link appears broken... twice as badly... https://jupiter.challenges.picoctf.org/problem/51400 or http://jupiter.challenges.picoctf.org:51400
 

## Hints

> This is only a JavaScript problem.


## Approach & Solution

This is similar to the challenge `Java Script Kiddie`. We're gonna do the same steps.

Source code of the website:

```

<html>
	<head>    
		<script src="jquery-3.3.1.min.js"></script>
		<script>
			var bytes = [];
			$.get("bytes", function(resp) {
				bytes = Array.from(resp.split(" "), x => Number(x));
			});

			function assemble_png(u_in){
				var LEN = 16;
				var key = "00000000000000000000000000000000";
				var shifter;
				if(u_in.length == key.length){
					key = u_in;
				}
				var result = [];
				for(var i = 0; i < LEN; i++){
					shifter = Number(key.slice((i*2),(i*2)+1));
					for(var j = 0; j < (bytes.length / LEN); j ++){
						result[(j * LEN) + i] = bytes[(((j + shifter) * LEN) % bytes.length) + i]
					}
				}
				while(result[result.length-1] == 0){
					result = result.slice(0,result.length-1);
				}
				document.getElementById("Area").src = "data:image/png;base64," + btoa(String.fromCharCode.apply(null, new Uint8Array(result)));
				return false;
			}
		</script>
	</head>
	<body>

		<center>
			<form action="#" onsubmit="assemble_png(document.getElementById('user_in').value)">
				<input type="text" id="user_in">
				<input type="submit" value="Submit">
			</form>
			<img id="Area" src=""/>
		</center>

	</body>
</html>


```

We can see that the only difference is that the key's length is 32 characters, and the shifter is taking the values of the even indexes (0,2,4...,30).
That said, it doesn't matter what numbers are in the odd indexes, so we're gonna do the same as the previous challenge:

+ result\[0\]= 89 ===> possible shifter value at index 0 by looking at offset in HxD: 6
+ result\[2\]= 50 ===> possible shifter value at index 1 by looking at offset in HxD: 0
+ result\[4\]= 4E ===> possible shifter value at index 2 by looking at offset in HxD: 5
+ result\[6\]= 47 ===> possible shifter value at index 3 by looking at offset in HxD: 3
+ result\[8\]= 0D ===> possible shifter value at index 4 by looking at offset in HxD: 1
+ result\[10\]= 0A ===> possible shifter value at index 5 by looking at offset in HxD: 8
+ result\[12\]= 1A ===> possible shifter value at index 6 by looking at offset in HxD: 1
+ result\[14\]= 0A ===> possible shifter value at index 7 by looking at offset in HxD: 7
+ result\[16\]= 00 ===> possible shifter value at index 8 by looking at offset in HxD: 9
+ result\[18\]= 00 ===> possible shifter value at index 9 by looking at offset in HxD: 5,6
+ result\[20\]= 00 ===> possible shifter value at index 10 by looking at offset in HxD: 7,8
+ result\[22\]= 0D ===> possible shifter value at index 11 by looking at offset in HxD: 2
+ result\[24\]= 49 ===> possible shifter value at index 12 by looking at offset in HxD: 6
+ result\[26\]= 48 ===> possible shifter value at index 13 by looking at offset in HxD: 3
+ result\[28\]= 44 ===> possible shifter value at index 14 by looking at offset in HxD: 0
+ result\[30\]= 52 ===> possible shifter value at index 15 by looking at offset in HxD: 9

By brute-forcing the 4 options of the key, we get that the correct key is: `60005030108010709050702060300090`

Next, we download the QR code image, decode it using [this site](https://zxing.org/w/decode.jspx), and get the flag: `picoCTF{59d5db659865190a07120652e6c77f84}`


## Final Answer

`picoCTF{59d5db659865190a07120652e6c77f84}`

