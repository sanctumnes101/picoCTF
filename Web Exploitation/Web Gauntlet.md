## Description

> Can you beat the filters? Log in as admin http://jupiter.challenges.picoctf.org:40791/ http://jupiter.challenges.picoctf.org:40791/filter.php
 

## Hints

> You are not allowed to login with valid credentials.
> Write down the injections you use in case you lose your progress.
> For some filters it may be hard to see the characters, always (always) look at the raw hex in the response.
> sqlite
> If your cookie keeps getting reset, try using a private browser window


## Approach & Solution

Resources I used: **https://portswigger.net/web-security/sql-injection/cheat-sheet** 

First of all, let's check out the website. 
+ Open http://jupiter.challenges.picoctf.org:40791 in a new tab.
+ Open http://jupiter.challenges.picoctf.org:40791/filter.php in a new tab.

On the homepage, we have to beat 5 rounds. Let's enter some random input and see what happens. Entering `Username:asd` and `Password:asd` gives us the following SQL statement in the back ground: `SELECT * FROM users WHERE username='asd' AND password='asd'`. Ok so we have to use SQL injections to beat the rounds.
Usually when injecting, we care about the `admin` account. Let's try to change the SQL statement above and login as `admin`. In the filters page, we see that only the `or` operator is filtered.


**SQL statement to modify: `SELECT * FROM users WHERE username='asd' AND password='asd'`**


### Round 1

We need to make it look like: `SELECT * FROM users WHERE username='admin'...`, also, we don't want the password to be checked so let's comment it out using the `--` operator!

Final statement would look like: `SELECT * FROM users WHERE username='admin'-- AND password='asd'`.

So, the payload we have to use is: `admin'--` in the `username` field, and `asd` in the `password` field.


### Round 2

Refresh the filters page. We now see that `or and like = --` operators are filtered. In the previous payload, we used `--` operator, we can't use it now.
Let's try to end the statement after the username by using the `;` operator.

Final statement would look like: `SELECT * FROM users WHERE username='admin'; AND password='asd'`.

So, the payload we have to use is: `admin';` in the `username` field, and `asd` in the `password` field.


### Round 3

Refresh the filters page. We now see that `or and = like > < --` operators are filtered. In the previous payload, we didn't use any of these filtered operators, so we might as well use the same payload!

Final statement would look like: `SELECT * FROM users WHERE username='admin'; AND password='asd'`.

So, the payload we have to use is: `admin';` in the `username` field, and `asd` in the `password` field.


### Round 4

Refresh the filters page. We now see that  `or and = like > < -- admin` operators are filtered. We have to find another way to login as `admin` without using the word `admin` in the payload.

By doing some research, I found out that you can concatinate strings in SQL using the `||` operator. So by forming the word `admin` as a concatination of a prefix of it and the continuation suffix, such as `ad` and `min`, we can use the previous payloads to bypass the filter.

Final statement would look like: `SELECT * FROM users WHERE username='ad'||'min'; AND password='asd'`.

So, the payload we have to use is: `ad'||'min';` in the `username` field, and `asd` in the `password` field.


### Round 5 

Refresh the filters page. We now see that  `or and = like > < -- union admin` operators are filtered. We didn't use any of these in the previous payload, so we can use it here too!

Final statement would look like: `SELECT * FROM users WHERE username='ad'||'min'; AND password='asd'`.

So, the payload we have to use is: `ad'||'min';` in the `username` field, and `asd` in the `password` field.


### Finding the flag

Refresh the filters page after beating all of the 5 rounds, scroll down to the bottom and you will see the flag: `picoCTF{y0u_m4d3_1t_96486d415c04a1abbbcf3a2ebe1f4d02}`


## Final Answer

`picoCTF{y0u_m4d3_1t_96486d415c04a1abbbcf3a2ebe1f4d02}`
